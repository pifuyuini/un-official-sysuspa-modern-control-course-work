# **CoLabM** — **C**ontrol-**o**riented **Lab**oratory for active isolation in **M**IMO systems

The following materials constitute the open-source content accompanying the final project of the course *Modern Control Theory and Technology*. They mainly include:

1. Background of the final project
2. Interpretation of the project objectives and requirements
3. Construction of the Simulink simulation model
   3.1 Loading of the original system
   3.2 Incorporation of disturbances and noise
   3.3 Open-loop simulation
   3.4 Closed-loop simulation
4. Design rationale of the LQG controller
5. Performance metrics and data processing
   5.1 Power spectral density (PSD) plotting and illustrative examples
   5.2 Additional related content

---

## 1. Background of the Final Project

The ground simulation system of the TianQin Project is designed to validate drag-free control technologies, one of whose core requirements is the effective isolation of ground-induced vibrations. However, purely passive vibration isolation devices exhibit limited attenuation capability in the low-frequency range and are therefore insufficient to meet the stringent disturbance suppression requirements of high-precision ground-based simulation experiments. Consequently, it becomes necessary to introduce active control strategies on top of passive isolation in order to enhance the overall vibration isolation performance.

The controlled plant investigated in this course project is a compact three-degree-of-freedom active vibration isolation platform, as illustrated in the figure. Two inertial sensors are installed at the center of the platform to measure velocity signals in the horizontal and vertical directions, providing essential state-related information for active control. In addition, the platform is equipped with three voice coil actuators: one actuator is responsible for horizontal motion control, while the remaining two form a dual-actuator configuration for the vertical direction, enabling independent control of the vertical degree of freedom. This sensor–actuator architecture constitutes a typical multi-input multi-output (MIMO) active vibration isolation system, which provides a concrete physical basis for subsequent controller design, controllability and observability analysis, state estimation, and the development of Kalman filtering techniques.

![alt text](appendix/diagram_of_the_controlled_object.jpg)

---

## 2. Interpretation of the Project Objectives and Requirements

As a representative MIMO mechanical system, the active vibration isolation platform poses multiple challenges in both modeling and control design. First, due to its structural characteristics, significant coupling exists among the horizontal, vertical, and in-plane rotational degrees of freedom. As a result, conventional single-input single-output (SISO) control strategies based on independent channels are generally inadequate for suppressing cross-axis interactions. Second, the platform relies solely on inertial sensors that provide velocity measurements, rendering certain displacement variables and internal states unmeasurable. This limitation not only constrains the achievable performance of output-feedback controllers but also imposes higher demands on state estimation and noise modeling. Furthermore, the bandwidth, noise characteristics, and saturation limits of the voice coil actuator drivers introduce inherent trade-offs between low-frequency vibration isolation and high-frequency noise suppression, making it more challenging to achieve high-performance closed-loop responses while maintaining sufficient stability margins.

On the other hand, the project materials provide a linearized state-space model of the platform, which establishes a clear mathematical foundation for subsequent control design. The system comprises three degrees of freedom—horizontal, vertical, and in-plane rotation—and, with an appropriate choice of state variables, can be represented by a ten-dimensional state vector. The corresponding state-space equations are given by

$$
\dot{x} = A x + B u, \quad y = C x + D u.
$$

Here, the matrix $A \in \mathbb{R}^{10 \times 10}$ describes the linearly coupled dynamics among displacements and velocities along the three axes. The input matrix $B \in \mathbb{R}^{10 \times 5}$ corresponds to five inputs, including three control force inputs generated by the voice coil actuators $(u_1, u_2, u_3)$, which actuate the horizontal and two vertical directions, as well as two disturbance inputs $(\lambda u_4, \lambda u_5)$ representing vertical and horizontal ground displacement excitations. The output matrix $C \in \mathbb{R}^{4 \times 10}$ maps the system states to four measured velocity outputs $(y_1, \ldots, y_4)$, obtained from the inertial sensors located at the left vertical, right vertical, left horizontal, and right horizontal positions. The direct transmission matrix $D$ is zero, indicating the absence of direct feedthrough from inputs to outputs. Accordingly, the platform can be regarded as a MIMO system with three control inputs, two disturbance inputs, and four measurement outputs. All subsequent controller designs, controllability and observability analyses, state estimation procedures, and Kalman filter implementations are developed on the basis of this model.

Within this modeling framework, the objectives of the course project can be summarized at four progressive levels. First, classical decoupling controllers are to be designed based on the given state-space model and channel structure, followed by an analysis of their performance and limitations in the absence of state estimation. Second, the controllability and observability of the system are to be systematically examined, and state-feedback control laws and state observers are to be constructed in order to assess the impact of unobservable states on closed-loop performance. Third, a Kalman filter is to be independently derived and implemented to obtain optimal linear unbiased state estimates under noisy measurement conditions. Fourth, a multivariable MIMO controller is to be designed for the three-input, four-output system and quantitatively compared with the control strategies developed in the previous stages, thereby enabling a systematic evaluation of the advantages and applicability of modern control methods in active vibration isolation problems.

In the first stage of the project, a “classical decoupling controller” is designed based on the provided linearized model, and its closed-loop performance is validated. Taking advantage of the high degree of structural symmetry of the platform, as well as the paired arrangement of inertial sensors and vertical actuators, a design strategy combining physical symmetric/antisymmetric coordinate transformations with numerical optimization is adopted. This approach first transforms the original MIMO system into a set of virtual channels with clearer physical interpretations and significantly reduced coupling. Classical SISO controllers are then designed independently for these virtual channels. Compared with strict diagonalization of the full transfer matrix, this method avoids excessive implementation complexity and better satisfies practical engineering requirements in terms of interpretability and realizability. Externally, the resulting decoupling controller behaves as a three-input, four-output MIMO control law, while internally it consists of several nearly independent SISO control loops, providing a classical benchmark for subsequent state-space and MIMO controller designs.

In active vibration isolation systems, accurate knowledge of the platform’s dynamic states is a prerequisite for achieving high-performance feedback control. In practice, however, sensor measurements are inevitably corrupted by noise, and not all system states are directly accessible. Consequently, relying solely on raw sensor outputs is insufficient to meet the control system’s demand for high-quality state information. It is therefore essential to construct a filter capable of providing optimal linear state estimates in noisy environments.

Accordingly, this project derives and implements a Kalman filter based on the stochastic dynamic model of the system. Starting from noise-driven continuous-time stochastic systems, the theoretical foundation of optimal filtering is established. The recursive algorithm of the discrete-time Kalman filter is then presented, with explicit prediction and update steps suitable for practical implementation. Finally, the filter is integrated with the active vibration isolation platform model to provide a reliable and high-accuracy state estimation mechanism for subsequent MIMO controller design. As a key component of the Linear Quadratic Gaussian (LQG) control framework, the Kalman filter plays a critical role in ensuring system stability and enhancing vibration isolation performance.

Within the linear multivariable control framework, the Linear Quadratic Gaussian (LQG) approach offers a systematic and rigorous design methodology for optimal control of noisy dynamic systems. By combining an optimal state-feedback controller (LQR) with an optimal state estimator (LQE, namely the Kalman filter), LQG control addresses situations in which system states are not fully measurable and the dynamics are subject to stochastic disturbances. For MIMO systems such as the active vibration isolation platform considered in this project, the LQG method is particularly well suited to handling coupled dynamics, measurement noise, and uncertainties, and therefore represents a natural choice for the synthesis of high-performance controllers.

---

## 3. Construction of the Simulink Simulation Model

Based on the given linearized state-space representation, a comprehensive Simulink simulation model of the active vibration isolation system is constructed to evaluate the closed-loop performance of different control strategies under disturbance and noise conditions. The overall model adopts a modular architecture, consisting of the controlled plant, ground disturbance models, sensor noise models, signal conditioning blocks, and controller subsystems, which facilitates systematic analysis and future extensions.

### 3.1 Loading of the Original System and Channel Decomposition

The simulation starts by loading the continuous-time linearized model from the data file `Original+model.mat`. The state-space matrices $A$, $B$, $C$, and $D$ describe a three-degree-of-freedom active vibration isolation platform with a ten-dimensional state vector. According to the physical interpretation of the inputs, the input matrix $B$ is decomposed into control and disturbance channels: the first three inputs correspond to the control forces generated by the voice coil actuators, while the remaining two inputs represent ground displacement disturbances in the horizontal and vertical directions. The output matrix $C$ maps the system states to four velocity measurements provided by the inertial sensors.

In Simulink, the controlled plant is implemented using a continuous-time State-Space block. Control inputs and disturbance inputs are injected through separate signal paths, allowing a clear structural separation between control actions and external excitations.

### 3.2 Modeling of Ground Disturbances

To characterize the influence of ground-induced vibrations, a ground disturbance model based on zero–pole dynamics is incorporated into the simulation. The disturbance dynamics employ complex-conjugate zeros and multiple poles to reproduce the dominant low-frequency spectral characteristics of realistic ground motion. The overall gain is normalized according to physical scaling considerations.

Both ground displacement and its rate-related effects are modeled by constructing corresponding zero–pole systems and converting them into state-space form. These disturbance signals are then injected into the disturbance input channels of the controlled plant, ensuring that the system operates under continuous external excitation during simulation and enabling a realistic assessment of vibration isolation performance.

### 3.3 Sensor Noise Modeling and Signal Conditioning

To account for measurement imperfections, sensor noise subsystems are introduced to emulate the noise characteristics of inertial sensors. The sensor noise is modeled using a continuous-time zero–pole representation, with parameters selected according to the specified noise spectral density level and scaled to reflect ultra-low-noise measurement conditions.

In the Simulink implementation, the noise signals are superimposed on the true system outputs. The resulting signals are then passed through analog-to-digital conversion (ADC) and signal conditioning blocks to produce discrete-time measurement signals, which serve as inputs to output-feedback or state-estimation-based controllers.

### 3.4 Controller Integration and Overall Simulation Framework

On top of the plant, disturbance, and noise models, the controller is implemented as an independent subsystem within the Simulink framework. This structure allows flexible switching among classical decoupling control, state-feedback control, and LQG control schemes. A uniform sampling frequency of $f_s = 10\text{kHz}$, corresponding to a sampling period of $T_s = 0.1\text{ms}$, is adopted throughout the simulation to ensure accurate representation of high-frequency dynamics and noise effects.

The resulting Simulink model provides a unified and reliable numerical platform for systematically analyzing open-loop and closed-loop system responses, vibration isolation performance, and noise suppression capabilities under different control strategies.

---

## 4. Design Rationale of the LQG Controller

The Linear Quadratic Gaussian (LQG) control framework integrates optimal control and optimal estimation theories into a unified design methodology, making it particularly suitable for linear systems whose states are not fully measurable and are subject to stochastic disturbances and measurement noise. In this project, LQG control is adopted to address the high-performance control requirements of an active vibration isolation platform, which represents a typical multi-input multi-output (MIMO) system operating in a noisy environment.

### 4.1 LQR State Feedback Control Law

Starting from optimal control theory, a quadratic performance index is formulated for the given linear system, leading to the design of a Linear Quadratic Regulator (LQR). By solving the associated algebraic Riccati equation, the optimal state feedback gain matrix (K) is obtained, yielding the control law

$$
u(t) = -K x(t).
$$

This control law guarantees both asymptotic stability and optimal energy performance of the closed-loop system in the quadratic cost sense. For general MIMO systems, the LQR gain matrix $K$ explicitly captures the internal coupling among system states and control channels, enabling coordinated control across different inputs and achieving global optimality.

### 4.2 Kalman Filtering and Optimal State Estimation

In practical applications, however, the full system state is rarely available for direct measurement, and relying solely on sensor outputs is insufficient to meet the information requirements of state feedback control. To overcome this limitation, an optimal state estimator, namely the Linear Quadratic Estimator (LQE), is constructed. In both continuous-time and discrete-time settings, the LQE corresponds to the Kalman filter.

When the noise covariance matrices $Q$ and $R$, as well as the system matrices $A$ and $C$, are time-invariant, and appropriate detectability and stability conditions are satisfied, the estimation error covariance matrix $P(t)$ converges to a unique steady-state solution $P_\infty$. This steady-state covariance satisfies the algebraic Riccati equation

$$
A P_\infty + P_\infty A^\mathrm{T} - P_\infty C^\mathrm{T} R^{-1} C P_\infty + Q = 0.
$$

The corresponding steady-state Kalman gain is given by

$$
J_s^\infty = P_\infty C^\mathrm{T} R^{-1},
$$

which leads to a linear observer with constant gain. This estimator is optimal in the mean-square error sense and, owing to its constant-gain structure, significantly reduces implementation complexity and real-time computational burden. These features make it particularly suitable for active vibration isolation systems that require high-speed state reconstruction.

### 4.3 LQG Controller Structure and Separation Principle

The key idea of LQG control lies in the series connection of optimal state estimation and optimal state feedback control. The Kalman filter provides an optimal estimate $\hat{x}(t)$ of the system state under noisy measurements, which is then used by the LQR controller in place of the true state to compute the control input, resulting in

$$
u(t) = -K \hat{x}(t).
$$

Under standard assumptions, the LQG controller satisfies the separation principle, which states that the estimator and the controller can be designed independently, while the resulting closed-loop system remains optimal in a statistical sense. This property greatly simplifies the controller design procedure and enhances its practical applicability to MIMO systems characterized by noise disturbances, incomplete information, and strong dynamic coupling.

In summary, the LQG-based MIMO control strategy leverages LQR to optimize control performance and employs steady-state Kalman filtering to achieve reliable state estimation. By combining optimality, robustness to noise, and implementation efficiency, the LQG framework provides a high-performance control solution well suited for active vibration isolation applications.

---

## 5. Performance Metrics and Data Processing

To quantitatively evaluate the vibration isolation performance of different control strategies, the power spectral density (PSD) is adopted as the primary performance metric in this project. PSD provides a frequency-domain description of how signal energy is distributed over frequency and is widely used to assess vibration suppression, resonance attenuation, and noise propagation characteristics in isolation systems.

### 5.1 PSD Estimation Method and Implementation

In the data processing stage, the sampling parameters are first determined from the simulated time series. The sampling frequency $f_s$ is obtained from the time step, and a target frequency resolution $\Delta f$ is specified to define the effective analysis duration $T_{\mathrm{eff}} = 1 / \Delta f$. This leads to a segment length $M = f_s T_{\mathrm{eff}}$ for the Welch method. Such a configuration ensures adequate low-frequency resolution while reducing the variance of the spectral estimate.

PSD estimation is performed using the Welch averaged periodogram method for system output signals under different control strategies. In particular, velocity outputs in the vertical and horizontal directions on both sides of the platform are processed independently. The resulting PSD curves are plotted on logarithmic axes, enabling direct comparison across multiple decades of frequency.

As illustrated by the vertical rotating output example, the low-frequency range of the PSD reflects the controller’s ability to suppress ground disturbances and structural resonances, the mid-frequency range reveals the effects of control bandwidth and dynamic coupling, and the high-frequency range is dominated by sensor noise and controller roll-off characteristics. The results indicate that the MIMO LQG controller achieves superior resonance suppression and overall energy reduction, while the decoupled LQG strategy further improves performance in specific frequency bands without sacrificing multivariable coordination.

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import welch

# ===============================
# Sampling parameters
# ===============================
dt = t[1] - t[0]              # time step
fs = 1.0 / dt                 # sampling frequency
T = t[-1] - t[0]              # total duration
L = len(t)

# Frequency resolution setting
Delta_f = 0.01                # target frequency resolution [Hz]
T_eff = 1.0 / Delta_f         # effective time length
M = int(fs * T_eff)           # segment length for Welch

print('Welch segment length M:', M)
print('Number of averages L/M:', L / M)

# ===============================
# PSD computation
# ===============================
f, P_VL_c1 = welch(y_VL_c1, fs=fs, nperseg=M)
_, P_HL_c1 = welch(y_HL_c1, fs=fs, nperseg=M)

_, P_VL_c2 = welch(y_VL_c2, fs=fs, nperseg=M)
_, P_HL_c2 = welch(y_HL_c2, fs=fs, nperseg=M)

_, P_VL_o  = welch(y_VL_o,  fs=fs, nperseg=M)
_, P_HL_o  = welch(y_HL_o,  fs=fs, nperseg=M)

_, P_VR_c1 = welch(y_VR_c1, fs=fs, nperseg=M)
_, P_VR_c2 = welch(y_VR_c2, fs=fs, nperseg=M)
_, P_VR_o  = welch(y_VR_o,  fs=fs, nperseg=M)

# Sensor noise PSD (optional)
_, P_ns = welch(ns, fs=fs, nperseg=M)

# ===============================
# Plotting
# ===============================
plt.figure(figsize=(7, 5))

plt.loglog(f, P_VR_o,  label='SISO', linewidth=1.8)
plt.loglog(f, P_VR_c1, label='LQG', linewidth=1.8)
plt.loglog(f, P_VR_c2, label='Decoupled LQG', linewidth=1.8)

plt.xlabel('Frequency [Hz]')
plt.ylabel('PSD [(m/s)$^2$/Hz]')
plt.title('Comparison of PSD of Vertical Rotating Output')
plt.legend()
plt.grid(True, which='both', ls='--', alpha=0.5)
plt.tight_layout()

plt.savefig('psd_comparison.pdf')
plt.show()
```

![alt text](appendix/psd_example.png)

### 5.2 Additional Metrics (To Be Added)
